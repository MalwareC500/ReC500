# Hướng dẫn cài đặt các module
## 1. Module 3.1.3
### 1.1. Cài đặt kafka và zookeeper
- Cài đặt zookeeper:
```bash
sudo apt install zookeeperd
```
- Cài đặt kafka:
Phiên bản: 2.1.0 - scala 2.11 (địa chỉ: https://www.dropbox.com/s/lpcksro588cqswx/kafka_2.11-2.1.0.tar.gz)
```bash
cd /tmp
wget https://www.dropbox.com/s/bc36rcxb5n97q33/kafka_2.11-2.1.0.tgz #tải kafka
tar xvf kafka_2.11-2.1.0.tar.gz
sudo rm -rf /usr/local/kafka
sudo mv kafka_2.11-2.1.0 /usr/local/kafka
# cấu hình để kafka kh
wget https://www.dropbox.com/s/i74u2kj1l1a2mi5/kafka.service
sudo mv kafka.service /etc/systemd/system/kafka.service
sudo systemctl start kafka.service
sudo systemctl enable kafka.service
# tạo các topics
/usr/local/kafka/bin/kafka-topics.sh --create --topic RawApacheLog --zookeeper localhost:2181 --partitions 1 --replication-factor 1
/usr/local/kafka/bin/kafka-topics.sh --create --topic RawIISLog --zookeeper localhost:2181 --partitions 1 --replication-factor 1
/usr/local/kafka/bin/kafka-topics.sh --create --topic RawBINDLog --zookeeper localhost:2181 --partitions 1 --replication-factor 1
/usr/local/kafka/bin/kafka-topics.sh --create --topic RawMSDNSLog --zookeeper localhost:2181 --partitions 1 --replication-factor 1

/usr/local/kafka/bin/kafka-topics.sh --create --topic TreatedWebLog --zookeeper localhost:2181 --partitions 1 --replication-factor 1
/usr/local/kafka/bin/kafka-topics.sh --create --topic TreatedDNSLog --zookeeper localhost:2181 --partitions 1 --replication-factor 1
```
hoặc:
```bash
wget https://www.dropbox.com/s/vlylbobxdlt005u/install_kafka.sh
sh ./install_kafka.sh
```
### 1.2. Cài đặt module tiền xử lý và chuẩn hóa log
- Cài đặt môi trường:
nodejs và yarn:
```bash
sudo apt install curl
curl -sS https://dl.yarnpkg.com/debian/pubkey.gpg | sudo apt-key add -
echo "deb https://dl.yarnpkg.com/debian/ stable main" | sudo tee /etc/apt/sources.list.d/yarn.list
sudo apt install yarn
sudo apt install nodejs
```
- Cài đặt module 3.1.3:
```bash
cd /tmp
wget https://www.dropbox.com/s/rztmvzxr6shmdig/3.1.3.tar.gz
tar -xvzf 3.1.3.tar.gz
rm -rf 3.1.3.tar.gz
sudo mkdir /usr/local/kc05
sudo rm -rf /usr/local/kc05/3.1.3
sudo mv 3.1.3 /usr/local/kc05/3.1.3
cd /usr/local/kc05/3.1.3
yarn
sudo chmod +x /usr/local/kc05/3.1.3/bin/*
cd /tmp
wget https://www.dropbox.com/s/i4sf9p9s072fylm/parse_msdns.service
sudo mv parse_msdns.service /etc/systemd/system/parse_msdns.service
wget https://www.dropbox.com/s/xv4l2yqwrznlzc5/parse_iis.service
sudo mv parse_iis.service /etc/systemd/system/parse_iis.service
wget https://www.dropbox.com/s/p8ya5v0n36l7upf/parse_bind.service
sudo mv parse_bind.service /etc/systemd/system/parse_bind.service
wget https://www.dropbox.com/s/g51d6so17j9e755/parse_apache.service
sudo mv parse_apache.service /etc/systemd/system/parse_apache.service
sudo systemctl start parse_msdns.service
sudo systemctl start parse_iis.service
sudo systemctl start parse_bind.service
sudo systemctl start parse_apache.service
sudo systemctl enable parse_msdns.service
sudo systemctl enable parse_iis.service
sudo systemctl enable parse_bind.service
sudo systemctl enable parse_apache.service
```
